<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <!-- BEGIN CHANGE ME -->
    <title>Reproducible Research Through Reusable Code - Workshop Slides</title>
    <meta name="description" content="Reproducible research is the foundation of science. This workshop is tailored for PhD candidates and Research Software Engineers affiliated with Dutch research institutions who would like to learn more about how to apply best practices to make your research reproducible through reusable code.">
    <meta name="author" content="Ole Mussmann, Malte Lüken">
    <!-- END CHANGE ME -->

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="./files/favicon-32x32.png">
    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <script src="http://localhost:35729/livereload.js"></script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

        <!-- BEGIN YOUR SLIDES -->
        <section
          data-state="blue_overlay yellow_flag yellow_strip purple_half_circle_bottom purple_blob right_e_top"
          data-background-video="./files/Mood video Homepage 2.mp4"
          data-background-video-loop
          data-background-video-muted="true"
          data-markdown>
            <textarea data-template>
              # Reproducible research through reusable code
              
              [Malte Luken](mailto:m.luken@esciencecenter.nl), [Ole Mussmann](mailto:o.mussmann@esciencecenter.nl)
              
              <p><small>Slides based on the Carptentries workshop <em>Reproducible research through reusable code in 1 day</em> developed by Sven van der Burg and Eduard Klapwijk under the CC-BY 4.0 license</small></p>
            </textarea>
          </section>

          <section> <!-- start of Introduction -->
            <section data-state="standard">
              <h2>Introduction</h2>
              <p>Reproducibility: Definitions, Advantages, and Barriers</p>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### What is reproducible research? 

                <figure>
                  <img src="files/reproducible-matrix.jpg"
                      alt="Reproducibility matrix."
                      width="555" height="285">
                  <figcaption><small>The Turing Way Community. (2022). <em>The Turing Way: A handbook for reproducible, ethical and collaborative research (1.0.2)</em>. Zenodo. https://zenodo.org/records/7625728</small></figcaption>
                </figure>
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Why should we care about reproducible research? 

                <figure>
                  <img src="files/reasons-reproducibil.png"
                      alt="Reasons for reproducible research."
                      width="600" height="330">
                  <figcaption><small>The Turing Way Community. (2022). <em>The Turing Way: A handbook for reproducible, ethical and collaborative research (1.0.2)</em>. https://zenodo.org/records/7625728</small></figcaption>
                </figure>
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Barriers to reproducibility

                - Limited incentives:
                  - Making yourself vulnerable ("plead the fifth")
                  - Held to higher standards
                  - Not important for career/promotions
                  - Publication bias
                - Resources:
                  - Takes time
                  - Requires new skills
                - Infrastructure:
                  - Big data
                  - Computational complexity
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Where to start

                - Philosophy: Partial reproducibility > no reproducibility!
                - Small steps: Improve practices from one project to the next
                - Use checklists to get an overview
                - Good starting point: Version control
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Version control and reproducibility

                - Tracks which versions of the code and data led to which results reported in a paper
                - Tracks a version history to follow changes over time
                - Hides older versions to avoid cluttering
                - Allows for collaborative development and tracks who made which changes
                - Different frameworks for code (e.g., git) and data (e.g., git-annex)
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### This workshop

                - Focus on computational reproducibility and resusable code
                - Gives you an overview of the most important aspects
                - Time to improve you own project and receive feedback from others
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Resources

                - The Turing Way Community. (2022). <em>The Turing Way: A handbook for reproducible, ethical and collaborative research (1.0.2)</em>. Zenodo. https://zenodo.org/records/7625728
                
              </textarea>
            </section>

          </section> <!-- end of Introduction -->

          <section> <!-- start of Software Dependencies -->
            <section data-state="standard" data-markdown>
              <textarea data-template>
                # Software Dependencies
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                # Your code
                ## depends on code
                ### which depends on code
                depending on other code
                <p style="font-size: smaller;"> which depends on code </p>
                <p style="font-size: large;"> ... </p>
              </textarea>
            </section>

            <section data-state="standard">
              <h2>It's code all the way down...</h2>
              <div class="tenor-gif-embed" data-postid="18021411" data-share-method="host" data-aspect-ratio="1.79775" data-width="100%"><a href="https://tenor.com/view/turtles-all-the-way-down-gif-18021411">Turtles All GIF</a>from <a href="https://tenor.com/search/turtles-gifs">Turtles GIFs</a></div> <script type="text/javascript" async src="https://tenor.com/embed.js"></script>
            </section>

            <section data-state="standard">
              <h2>... and it's a mess</h2>
              <img src="./files/dependency.png">
              <p style="font-size: smaller;"><a href="https://xkcd.com/2347/">xkcd.com/2347</a></p>
            </section>

            <section data-state="standard 2" data-background-image="./files/carrots-5956003_1920.jpg">
              <!-- Image by <a href="https://pixabay.com/users/igorkocka-19859205/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=5956003">IgorKocka</a> from <a href="https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=5956003">Pixabay</a> -->
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ## Software ↔️ <span class="fragment">Recipe</span><br>Data ↔️ <span class="fragment">Ingredients</span>

                <img style="height: 30vh;" src="./files/recipe.png">

                <p style="font-size: smaller;">Midjourney, CC-BY-NC 4.0</p>
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ## Libraries ↔️ <span class="fragment">Pots, Tools</span>

                <img style="height: 30vh;" src="./files/libraries.png">

                <p style="font-size: smaller;">Midjourney, CC-BY-NC 4.0</p>
              </textarea>
            </section>

            <section data-state="standard scroll">
              <h2>Many, <em>Many</em> Tools Wanting to Help</h2>
              <div id="scrollContainer" style="height: 40vh; overflow: hidden;">
                <div style="will-change: transform; position: relative;" id="scrollContent">
                  <ul id="scrollList">
                    <li>Conda</li>
                    <li>Anaconda</li>
                    <li>Miniconda</li>
                    <li>Mamba</li>
                    <li>Pixi</li>
                    <li>pip</li>
                    <li>virtualenv</li>
                    <li>Pipenv</li>
                    <li>pyenv</li>
                    <li>Poetry</li>
                    <li>requirements.txt</li>
                    <li>environment.yml</li>
                    <li>renv</li>
                    <li>uv</li>
                    <li>just</li>
                  </ul>
                </div>
              </div>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ## Package Managers

                - Define dependencies + versions
                - Install those dependencies
                - Record their versions
                - Isolate environments
                - Manage Python/R versions
                - Enable sharing packages
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ## [Challenge](https://carpentries-incubator.github.io/reproducible-research-through-reusable-code-in-1-day/software-dependencies.html#tools-and-what-problems-they-try-to-solve)

                <p class="fragment">(see collaborative doc)</p>
                <p class="fragment">(hey, don't peek at the solution!)</p>
              </textarea>
            </section>

            <section data-state="standard">
              <h2>A Time-Capsule for the Future</h2>

              <div style="width: 49%; float: left;">
                <h3>Python</h3>
                <pre style="width: fit-content;"><code data-trim class="language-bash">
                  $ pip freeze > requirements.txt
                </code></pre>

                What does the file contain?
                <br>
                Re-create this environment with:

                <pre style="width: fit-content;"><code data-trim class="language-bash">
                  $ pip install -r requirements.txt
                </code></pre>
                Self-study: <a href="https://carpentries-incubator.github.io/python-intermediate-development/12-virtual-environments.html#creating-virtual-environments-using-venv">Carpentries Lesson</a>
              </div>

              <div class="fragment" style="width: 49%; float: right;">
                <h3>R</h3>
                Initialize renv, and then “save” and “load” the state of your project library.

                <pre style="width: fit-content;"><code data-trim class="language-bash">
                  renv::init()
                  renv::snapshot()  # save
                  renv::restore()   # load
                </code></pre>

                Self-study: <a href="https://carpentries-incubator.github.io/reproducible-publications-quarto/15-renv.html">Carpentries Lesson</a>
              </div>
            </section>

            <section data-state="standard">
              <h2>Upload to GitHub</h2>

              <ul>
                <li><b>Add</b></li>
                <ul>
                  <li>VS Code: click '+' next to 'Changes' (or files)</li>
                  <li>RStudio: click 'Staged'</li>
                  <ul>
                    <li>N.B.: also include <code>.RProfile</code> and <code>activate.R</code></li>
                  </ul>
                  <li>git: <code>git add [filenames]</code></li>
                </ul>
                <li><b>Commit</b></li>
                <ul>
                  <li>IDEs: Write "add dependencies", click 'Commit'</li>
                  <li>git: <code>git commit -m "add dependencies"</code></li>
                </ul>
                <li><b>Push</b></li>
                <ul>
                  <li>IDEs: Click 'Push'</li>
                  <li>git: <code>git push</code></li>
                </ul>
              </ul>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ## Take-Away

                - Recording dependencies <em>with versions</em> can make it easier for another person to execute your code
                  - ⚠️ Another person is you, in three months ⚠️ <!-- .element: class="fragment" -->
                - There are many tools to record dependencies <!-- .element: class="fragment" -->
              </textarea>
            </section>
          </section> <!-- end of Software Dependencies -->

          <section> <!-- start of Software Documentation -->
            <section data-state="standard">
              <h2>Software Documentation</h2>
              <p>How to make software easier to understand</p>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Writing good README files

                - First landing page for other developers/users
                - On GitHub/GitLab/CRAN or attached to the software
                - Answers three questions:
                  - Why should I use the software?
                  - How do I use it?
                  - How can I install it?

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Structure of a good README

                - Descriptive title
                - Motivation (why?)
                - How to setup/install
                - Copy-pastable quick start code example
                - Link or instructions for contributing (see also CONTRIBUTING.md)
                - License
                - Recommended citation (see also CITATION.cff)

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### In-code documentation

                - Helps the reader understand the code
                - Explains development decisions we make
                - Does not repeat what is self-explanatory
                - Does not replace good variable/function/class names
                - Does not replace version control

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Readable vs. commented code

                ```python
                # convert from degrees celsius to fahrenheit
                def convert(d):
                    return d * 5 / 9 + 32
                ```

                vs.

                ```python
                def celsius_to_fahrenheit(degrees):
                    return degrees * 5 / 9 + 32
                ```

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Docstrings

                Using regular comments:

                ```python
                # This function converts a temperature in Fahrenheit to Celsius.
                def fahrenheit_to_celsius(temp_f: float) -> float:
                    temp_c = (temp_f - 32.0) * (5.0/9.0)
                    return temp_c
                ```

                Using docstrings:

                ```python
                def fahrenheit_to_celsius(temp_f: float) -> float:
                    """
                    Converts a temperature in Fahrenheit to Celsius.

                    Parameters
                    ----------
                    temp_f : float
                        The temperature in Fahrenheit.

                    Returns
                    -------
                    float
                        The temperature in Celsius.
                    """
                    return (temp_f - 32.0) * (5.0/9.0)
                ```

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Docstrings

                - Automatically generate help text
                - Automatically generate API documentation
                - Can be written for variables (constants), datasets, functions, classes, and modules
                - Different tools for each language (e.g., Sphinx for Python, roxygen for R)
                - Different styles (e.g., numpy vs. Google for Python)

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Writing good docstrings

                - Follow a style (e.g., numpy)
                - What does an object (e.g., function) do?
                - What is the input and the output (including types)?
                - Example on how to use the object (test your examples automatically)
                - Be concise (a docstring is not a tutorial or a scientific paper)

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Online documentation

                - Create your API documentation automatically (e.g., using Sphinx or roxygen)
                - Deploy your documentation automatically to a GitHub page or Read the Docs

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Resources

                - README guide and template: https://www.makeareadme.com/
                - Hemingway app: https://hemingwayapp.com/
                - Writing good comments: https://stackoverflow.blog/2021/12/23/best-practices-for-writing-code-comments/
                - numpydoc style guide: https://numpydoc.readthedocs.io/en/latest/format.html#
                - The Turing Way Community. (2022). <em>Writing human readable code</em>. Zenodo. https://zenodo.org/records/7625728

              </textarea>
            </section>

          </section> <!-- end of Software Documentation -->

          <section> <!-- start of Code Conventions and Modular Coding -->
            <section data-state="standard">
              <h2>html slides</h2>
              <p>content</p>
              <p>with html</p>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                # Header

                - list item
                - another one
              </textarea>
            </section>
          </section> <!-- end of Code Conventions and Modular Coding -->

          <section> <!-- start of Next Steps: How to make your code reusable -->
            <section data-state="standard">
              <h2>Next steps</h2>
              How to make your code reusable
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Add a license

                - Others cannot safely copy, modify, or distribute your work without a license
                - Common licenses for code:
                    - Apache 2.0
                    - MIT
                    - GNU GPLv3
                - Find a license that fits your project: https://choosealicense.com/
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### FAIR software checklist

                - Check how much your project adheres to the FAIR principles: https://fairsoftwarechecklist.net/v0.2/
                - Add a badge to your GitHub repository: https://github.com/fair-software/howfairis

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Add a CITATION file

                - Use the cff initializer to create a CITATION.cff file for you project: https://citation-file-format.github.io/cff-initializer-javascript/#/
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Publish your project on Zenodo

                - Link your GitHub repository to Zenodo: https://zenodo.org/login/?next=%2Faccount%2Fsettings%2Fgithub%2F
                - When you publish a release of your project, it will be uploaded to Zenodo and a DOI is assigned to it

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Publish your project on Zenodo

                - The Turing Way Community. (2022). <em>Licenses</em>. Zenodo. https://zenodo.org/records/7625728
                - List of approved licenses by Open Source Foundation: https://opensource.org/license?ls=apache

              </textarea>
            </section>

          </section> <!-- end of Next Steps: How to make your code reusable -->

          <section> <!-- start of Work on Your Own Project -->
            <section data-state="standard">
              <h2>html slides</h2>
              <p>content</p>
              <p>with html</p>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                # Header

                - list item
                - another one
              </textarea>
            </section>
          </section> <!-- end of Work on Your Own Project -->

          <section> <!-- start of Reusability Check -->
            <section data-state="standard">
              <h2>Reproducibility check</h2>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Reproducibility check

                - Share your project with one of your peers
                - Answer the following questions:
                  - Is the code clearly documented?
                  - Can you reuse the code?
                  - Are you able to rerun the code independently and can you reproduce results?
                  - How could the reusability of the project be improved?
                - Be constructive (reproducibility is difficult)
                - Be reasonable (not every project needs an end-to-end reproducibility workflow)

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Resources

                - ReproHack: https://www.reprohack.org/
                - CODECHECK: https://codecheck.org.uk/

              </textarea>
            </section>
          </section> <!-- end of Reusability Check -->

          <section> <!-- start of Wrap-Up -->
            <section data-state="standard">
              <h2>Wrap-up</h2>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Summary

                Ingredients for reusable code:
                - Version control
                - Code in public repository (e.g., GitHub, see also [Codeberg](https://codeberg.org/))
                - Description of dependencies
                - A good README (and documentation)
                - Readble code

              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Next steps

                - Philosophy: Partial reproducibility > no reproducibility!
                - Small steps: Improve practices from one project to the next
                - Get inspiration from prominent examples (e.g., numpy or tidyverse)
                - Pain point: Resources vs. pay-off
                  - Many reusability techniques take resources to learn/apply (e.g., git)
                  - <b>But</b>: They will also save resources in the future
                - Reusability should match the scope of your project
                
              </textarea>
            </section>

            <section data-state="standard" data-markdown>
              <textarea data-template>
                ### Reference and further reading

                - Carptentries workshop [material](https://carpentries-incubator.github.io/reproducible-research-through-reusable-code-in-1-day/index.html) <em>Reproducible research through reusable code in 1 day</em>
                - The Turing Way Community. (2022). <em>The Turing Way: A handbook for reproducible, ethical and collaborative research (1.0.2)</em>. Zenodo. https://zenodo.org/records/7625728
                
              </textarea>
            </section>
          </section> <!-- end of Wrap-Up -->

        <!-- END YOUR SLIDES -->
      </div>
    </div>

    <script src="dist/reveal.js"></script>

    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/math/math.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/search/search.js"></script>
    <script src="plugin/zoom/zoom.js"></script>
    <script src="plugin/escience/escience_5.1.0.js"></script>
    <!--
    <script src="reveal.js/4.3.1/reveal.js-plugins/menu/menu.js"></script>
    -->


    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Automatically activate the scroll view when we the viewport falls
        // below the given width.
        scrollActivationWidth: 0,  // disabled

        // Force the scrollbar to remain visible
        scrollProgress: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, Escience ]
      });

      // auto-scrolling
      let animationId = null;
      let running = false;

      const list = document.getElementById("scrollList");
      const content = document.getElementById("scrollContent");

      // Duplicate list a few times to fudge infinite scroll
      list.innerHTML += list.innerHTML;
      list.innerHTML += list.innerHTML;
      list.innerHTML += list.innerHTML;
      list.innerHTML += list.innerHTML;

      let y = 0;
      const speed = 0.1; // px per frame
      let loopHeight = 0;

      function start_scrolling() {
        if (running) return; // prevent duplicates
        running = true;

        // Measure after layout is complete
        loopHeight = list.offsetHeight;

        function animate() {
          if (!running) return;
          y += speed;

          if (y >= loopHeight) {
            y = 0;
          }

          content.style.transform = `translateY(-${y}px)`;
          animationId = requestAnimationFrame(animate);
        }

        animate();
      }

      function stop_scrolling() {
        running = false;
        if (animationId) {
          cancelAnimationFrame(animationId);
          animationId = null;
          console.log("stop scrolling");
        }
      }

      Reveal.on('slidechanged', event => {
        if (event.currentSlide.getAttribute('data-state').includes('scroll')) {
          start_scrolling();
          console.log("start scrolling");
        } else {
          stop_scrolling();
        }
      });
    </script>
  </body>
</html>
